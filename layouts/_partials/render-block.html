{{/* layouts/partials/render-block.html */}}
{{/*
Renders a block content by id.
Expects:
- .id: The id of the block to render
- .page: The current page context
*/}}

{{ $id := .id }}
{{ $page := .page }}
{{ $renderedContent := "" }}
{{ $background := "" }}

{{/* Construct the path to the block page */}}
{{ $blockPath := printf "blocks/%s" $id }}

{{/* Get the block page using its path */}}
{{ $block := $page.Site.GetPage $blockPath }}

{{ if $block }}
  {{ $background = $block.Params.background }}
  {{ if eq $block.Params.type "3-picture-circles" }}
    {{ $circleContent := "" }}
    {{ range (seq 1 3) }}
      {{ $circleContent = printf "%s%s" $circleContent (partial "picture-circle.html" (dict "block" $block "layout" 3 "index" .)) }}
    {{ end }}
    {{ $renderedContent = printf `<div class="kko-block kko-picture-circles"><div class="kko-picture-circles-layout">%s</div></div>` $circleContent }}
  {{ else if eq $block.Params.type "5-picture-circles" }}
    {{ $circleContent := "" }}
    {{ range (seq 1 5) }}
      {{ $circleContent = printf "%s%s" $circleContent (partial "picture-circle.html" (dict "block" $block "layout" 5 "index" .)) }}
    {{ end }}
    {{ $renderedContent = printf `<div class="kko-block kko-picture-circles"><div class="kko-picture-circles-layout">%s</div></div>` $circleContent }}
  {{ else }}
    {{ $renderedContent = printf `<div class="kko-block">%s</div>` ($block.Content | safeHTML) }}
  {{ end }}
{{ else }}
  {{ errorf "Block '%s' not found at path '%s'" $id $blockPath }}
{{ end }}

{{/* Return a dict with HTML content and background color */}}
{{ return (dict "html" $renderedContent "background" $background) }}
